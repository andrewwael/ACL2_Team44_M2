Exceeds Expectations statistics by age_group for Solo Female travellers.


MATCH (t:Traveller {type:'Solo', gender:'Female'})-[:WROTE]->(r:Review)-[:REVIEWED]->(h:Hotel)
WITH t.age AS age_group, h,
     (h.cleanliness_base + h.comfort_base + h.facilities_base) AS base_sum,
     avg(r.score_cleanliness + r.score_comfort + r.score_facilities) AS avg_review_sum
WITH age_group, base_sum, avg_review_sum,
     ((base_sum - avg_review_sum) / avg_review_sum) * 100 AS improve
WHERE base_sum >= avg_review_sum
RETURN age_group,
       round(min(improve), 2) AS min_improvement_pct,
       round(max(improve), 2) AS max_improvement_pct,
       round(avg(improve), 2) AS avg_improvement_pct
ORDER BY age_group;